\documentclass[11pt]{book}

% Packages
\usepackage{hyperref}
\usepackage{graphicx}
\usepackage{a4wide}
\usepackage{fancyhdr}
\usepackage{fancyvrb}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsfonts}
\usepackage{amsbsy}
\usepackage{bm}
\usepackage{psfrag}
\usepackage{makeidx}
\usepackage{longtable}
\usepackage{array}
\usepackage{algorithm}
\usepackage{algorithmicx}
\usepackage{algpseudocode}
\usepackage[procnames]{listings}
\usepackage[usenames]{color}
\usepackage{moreverb}
\usepackage{algorithm}
\usepackage{multicol}
\usepackage{url}
\usepackage{subfigure}
\usepackage{changepage}
\usepackage{xspace}
\usepackage{pythonhighlight}
\usepackage{subfigure}
\usepackage{textcomp}
\usepackage[only,llbracket,rrbracket]{stmaryrd}

% Bibliography
\usepackage[round,authoryear,comma,sort]{natbib}
\renewcommand{\cite}[1]{\citep{#1}}

% Set margins
%\usepackage[top=3cm, bottom=3cm, left=3cm, right=3cm]{geometry}

% Set table of contents depth
\setcounter{tocdepth}{0}

% Fonts and chapter styles
\usepackage{sectsty}
%\usepackage[Sonny]{fncychap}
%\usepackage{newcent}
%\usepackage{palatino}
\usepackage{mathpazo}

% Chapter title
\makeatletter
\renewcommand{\@makechapterhead}[1]{%
\vspace*{50 pt}%
{\setlength{\parindent}{0pt} \raggedright \normalfont
\Huge
\ifnum \value{secnumdepth}>1
   \it\if@mainmatter\thechapter.\ \fi%
\fi
#1\par\nobreak\vspace{40 pt}}}
\makeatother

% Section title
\sectionfont{\rm\it}
\subsectionfont{\rm\it}

% Headers
\lhead{\thepage}
\rhead{\small AUTOMATED SCIENTIFIC COMPUTING}
\cfoot{}
\chead{}
\renewcommand{\headrulewidth}{0pt}

% Clear empty page when chapter open right
\let\origdoublepage\cleardoublepage
\newcommand{\clearemptydoublepage}{%
  \clearpage
  {\pagestyle{empty}\origdoublepage}%
}

% Book macros
\newcommand{\fenicschapter}[4]{\chapter{#1} \vspace{-1cm} \Large By #3 \normalsize \vspace{1.5cm}}
\newcommand{\fenicsappendix}[2]{\chapter{#1} \chead{#2}}
\newcommand{\fenics}{\textbf{FEniCS}}
\newcommand{\dolfin}{\textbf{DOLFIN}}
\newcommand{\editornote}[1]{\noindent\begin{minipage}{\textwidth}
                            \small\it $\blacktriangleright$ \underline{\emph{Editor note}}: #1
                            \end{minipage}\normalsize \vspace{0.2cm}}
\newcommand{\authornote}[1]{\noindent\begin{minipage}{\textwidth}
                            \small\it $\blacktriangleright$ \underline{\emph{Author note}}: #1
                            \end{minipage}\normalsize \vspace{0.2cm}}
\newcommand{\includechapter}[1]{\include{chapters/#1/chapter}\clearemptydoublepage}
\newcommand{\includeappendix}[1]{\include{appendix/#1}\clearemptydoublepage}
\newcommand{\includemisc}[1]{\include{#1}\clearemptydoublepage}

% Widths, use for figures
\newcommand{\largewidth}{10cm}
\newcommand{\smallwidth}{5cm}
\newcommand{\codesize}{\footnotesize}

% Project names
\newcommand{\projectfont}[1]{{#1}}
\newcommand{\ufl}{\projectfont{UFL}}
\newcommand{\fiat}{\projectfont{FIAT}}
\newcommand{\ferrari}{\projectfont{FErari}}
\newcommand{\sfc}{\projectfont{SFC}}
\newcommand{\ufc}{\projectfont{UFC}}
\newcommand{\ffc}{\projectfont{FFC}}
\newcommand{\viper}{\projectfont{Viper}}
\newcommand{\pydolfin}{\projectfont{PyDOLFIN}}
\renewcommand{\dolfin}{\projectfont{DOLFIN}}
\renewcommand{\fenics}{\projectfont{FEniCS}}

% Package names
\newcommand{\packagefont}[1]{{#1}}
\newcommand{\numpy}{\packagefont{NumPy}}
\newcommand{\scipy}{\packagefont{SciPy}}
\newcommand{\sympy}{\packagefont{SymPy}}
%\newcommand{\python}{\packagefont{Python}}
\newcommand{\petsc}{\packagefont{PETSc}}
\newcommand{\diffsim}{\packagefont{DiffSim}}
\newcommand{\tetgen}{\packagefont{TetGen}}
\newcommand{\trilinos}{\packagefont{Trilinos}}
\newcommand{\vtk}{\packagefont{VTK}}
\newcommand{\itk}{\packagefont{ITK}}
\newcommand{\ginac}{\packagefont{GiNaC}}
\newcommand{\hypre}{\packagefont{HYPRE}}
\newcommand{\swig}{\packagefont{SWIG}}
\newcommand{\emp}[1]{\texttt{#1}}
\newcommand{\bit}{\begin{itemize}}
\newcommand{\eit}{\end{itemize}}
\newcommand{\slepc}{\projectfont{SLEPc}}

% Notation macros
\newcommand{\dx}{\, \mathrm{d}x}
\newcommand{\dX}{\, \mathrm{d}X}
\newcommand{\ds}{\, \mathrm{d}s}
\newcommand{\dS}{\, \mathrm{d}S}
\newcommand{\dt}{\, \mathrm{d}t}
\newcommand{\R}{\mathbb{R}}
\newcommand{\Hdiv}{H(\mathrm{div})}
\newcommand{\Hcurl}{H(\mathrm{curl})}
\newcommand{\tab}{\hspace*{2em}}
\newcommand{\Rset}{\ensuremath{\mathbb{R}}}
\newcommand{\inner}[2]{\langle #1, #2 \rangle}
\newcommand{\deltat}{\Delta t}

\newcommand{\nedelec}{N\'ed\'elec}
\newcommand{\babuska}{Babu\v{s}ka}

% Math operators
\DeclareMathOperator{\PE}{PE}
\DeclareMathOperator{\PEe}{PE_e}
\DeclareMathOperator{\e}{e}
\DeclareMathOperator{\Div}{div}
\DeclareMathOperator{\Grad}{grad}

% Example environment
\newtheorem{example}{Example}[chapter]

% Definition environment
\newtheorem{definition}{Definition}[chapter]

% Propopsition environment
\newtheorem{proposition}{Proposition}[section]

% Remark environment
\newtheorem{remark}{Remark}[section]

% Code environment
\DefineVerbatimEnvironment{code}{Verbatim}{fontsize=\footnotesize,frame=single,rulecolor=\color{blue}}
\newcommand{\codeinput}[1]{\VerbatimInput[fontsize=\footnotesize,frame=single,rulecolor=\color{blue}]{#1}}

% Create index
\makeindex

% Start with empty pagestyle
\pagestyle{empty}
